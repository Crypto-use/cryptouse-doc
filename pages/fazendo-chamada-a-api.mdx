# üîÑ Fazendo uma chamada √† API  
*(Making an API Call / Haciendo una llamada a la API)*

Utilizando o **AppID** que voc√™ obteve na se√ß√£o anterior, voc√™ pode fazer uma chamada √† API para criar um pedido.

*EN: Using the AppID you obtained earlier, you can make an API call to create an order.*

*ES: Usando el AppID que obtuviste anteriormente, puedes hacer una llamada a la API para crear una orden.*

---

## üß™ Exemplo de requisi√ß√£o para chamadas externas

```sh
curl -X POST https://api.cryptouse.com.br/api/external/crypto-pix/onchain/pay 
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <APPID>' \
-d '{
  "value": 10
}'
```

* Processa um pagamento via QR Code PIX, calcula as taxas correspondentes e cria uma ordem de pagamento em criptomoedas.

## üìù Corpo da Requisi√ß√£o (Request Body)

```sh
{
  "qrcode": "string",       // QR Code do pagamento PIX (formato texto / text format)
  "network": "string"       // Rede blockchain: "bsc" (padr√£o / default) ou "lightning"
}
```

* qrcode (obrigat√≥rio / obligatorio / required): C√≥digo QR PIX v√°lido como string.
* network (opcional / optional): "bsc" (padr√£o / default) ou "lightning". Se omitido, usa "bsc".

## ‚úÖ Resposta de Sucesso (200 OK)

```sh
{
  "data": {
    "pixKey": "chave-pix-do-recebedor",
    "payCryptoPixId": "cGlkMTIzNDU2...",  // ID base64 da ordem criada
    "value": "100.00"                     // Valor original do PIX em BRL
  }
}
```

## ‚ö†Ô∏è Erros Comuns (Common Errors)

### C√≥digo Mensagem de exemplo
* 400	QR Code inv√°lido ou ausente
* 400	Valor n√£o inclu√≠do ou inv√°lido	
* 400	Erro ao calcular valor em cripto	
* 400	Carteira mestre n√£o encontrada	
* 500	Falha ao descriptografar chave privada	


------


## üß™ Exemplo de requisi√ß√£o

```sh
curl -X POST https://api.cryptouse.com.br/api/order/create \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <APPID>' \
-d '{
  "value": 10
}'
```


## üì© Resposta esperada

A resposta ser√° algo parecido com isso:

```sh
{
  "message": "Order was successfully created",
  "merchant": {
    "status": "PENDING",
    "currency": "BRL",
    "removedAt": null,
    "_id": "67a53dc17306bc6a36cbc145",
    "value": 1000,
    "merchant": "67376f8e175ab9b65d283a29",
    "merchantTradeNo": "B30XOytptMzOhhxhkm1Cym0vhfxuJxgE",
    "qrCodeLink": "https://public.bnbstatic.com/static/payment/20250206/3e4e923c-2398-43ee-8c7c-1e5a451728dd.jpg",
    "universalUrl": "https://app.binance.com/payment/secpay?linkToken=12139d1b2e9e4cfeb5a0bd6ac866200e&_dp=Ym5jOi8vYXBwLmJpbmFuY2UuY29tL3BheW1lbnQvc2VjcGF5P3RlbXBUb2tlbj0wN09PZzRnS2tzaXNIT0Z3M09MMnYwZTduYWNrUWdHcSZjYW5jZWxMaW5rPWh0dHBzOi8vY3J5cHRvdXNlLmNvbS5ici9vcmRlci9mYWlsdXJl",
    "paymentLinkId": "03f351cd-d451-41ed-9cf5-080453ebff9d",
    "splits": [],
    "createdAt": "2025-02-06T22:54:57.335Z",
    "updatedAt": "2025-02-06T22:54:57.335Z",
    "__v": 0
  },
  "binanceResponse": {
    "status": "SUCCESS",
    "code": "000000",
    "data": {
      "currency": "USDT",
      "totalFee": "1.7262213",
      "fiatCurrency": "BRL",
      "fiatAmount": "10",
      "prepayId": "345843001167609856",
      "terminalType": "WEB",
      "expireTime": 1738886097088,
      "qrcodeLink": "https://public.bnbstatic.com/static/payment/20250206/3e4e923c-2398-43ee-8c7c-1e5a451728dd.jpg",
      "qrContent": "https://app.binance.com/qr/dplkf472a2547bc44632b7df7e05dae0260d",
      "checkoutUrl": "https://pay.binance.com/en/checkout/12139d1b2e9e4cfeb5a0bd6ac866200e",
      "deeplink": "bnc://app.binance.com/payment/secpay?tempToken=07OOg4gKksisHOFw3OL2v0e7nackQgGq&cancelLink=https://cryptouse.com.br/order/failure",
      "universalUrl": "https://app.binance.com/payment/secpay?linkToken=12139d1b2e9e4cfeb5a0bd6ac866200e&_dp=Ym5jOi8vYXBwLmJpbmFuY2UuY29tL3BheW1lbnQvc2VjcGF5P3RlbXBUb2tlbj0wN09PZzRnS2tzaXNIT0Z3M09MMnYwZTduYWNrUWdHcSZjYW5jZWxMaW5rPWh0dHBzOi8vY3J5cHRvdXNlLmNvbS5ici9vcmRlci9mYWlsdXJl"
    }
  }
}
```

üí° Observa√ß√µes

PT: No payload o value est√° como 10, mas a resposta mostra 1000. Isso ocorre porque os valores s√£o tratados em centavos (1 real = 100 centavos).

EN: In the payload, the value is 10, but the response shows 1000. That‚Äôs because values are measured in cents (1 BRL = 100 cents).

ES: En el payload, el value es 10, pero la respuesta muestra 1000. Esto es porque los valores est√°n en centavos (1 real = 100 centavos).